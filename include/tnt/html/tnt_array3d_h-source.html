<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tnt_array3d.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.5 on Wed Aug 28 02:51:39 2002 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>tnt_array3d.h</h1><a href="tnt_array3d_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">*</font>
00003 <font class="comment">* Template Numerical Toolkit (TNT): Three-dimensional numerical array</font>
00004 <font class="comment">*</font>
00005 <font class="comment">* Mathematical and Computational Sciences Division</font>
00006 <font class="comment">* National Institute of Technology,</font>
00007 <font class="comment">* Gaithersburg, MD USA</font>
00008 <font class="comment">*</font>
00009 <font class="comment">*</font>
00010 <font class="comment">* This software was developed at the National Institute of Standards and</font>
00011 <font class="comment">* Technology (NIST) by employees of the Federal Government in the course</font>
00012 <font class="comment">* of their official duties. Pursuant to title 17 Section 105 of the</font>
00013 <font class="comment">* United States Code, this software is not subject to copyright protection</font>
00014 <font class="comment">* and is in the public domain. NIST assumes no responsibility whatsoever for</font>
00015 <font class="comment">* its use by other parties, and makes no guarantees, expressed or implied,</font>
00016 <font class="comment">* about its quality, reliability, or any other characteristic.</font>
00017 <font class="comment">*</font>
00018 <font class="comment">*/</font>
00019 
00020 
00021 
00022 <font class="preprocessor">#ifndef TNT_ARRAY3D_H</font>
00023 <font class="preprocessor"></font><font class="preprocessor">#define TNT_ARRAY3D_H</font>
00024 <font class="preprocessor"></font>
00025 <font class="preprocessor">#include &lt;cstdlib&gt;</font>
00026 <font class="preprocessor">#include &lt;iostream&gt;</font>
00027 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00028 <font class="preprocessor"></font><font class="preprocessor">#include &lt;assert.h&gt;</font>
00029 <font class="preprocessor">#endif</font>
00030 <font class="preprocessor"></font>
00031 <font class="keyword">namespace </font>TNT
00032 {
00033 
00064 template &lt;class T&gt;
<a name="l00065"></a><a class="code" href="class_TNT__Array3D.html">00065</a> <font class="keyword">class </font>Array3D 
00066 {
00067 
00068 
00069   <font class="keyword">private</font>:
00070     T*** v_;                  
00071         <font class="keywordtype">int</font> m_;
00072     <font class="keywordtype">int</font> n_;
00073         <font class="keywordtype">int</font> k_;
00074     <font class="keywordtype">int</font> *ref_count_;
00075 
00076         <font class="keywordtype">void</font> initialize_(T* data, <font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k);
00077     <font class="keywordtype">void</font> copy_(T* p, <font class="keyword">const</font> T*  q, <font class="keywordtype">int</font> len) <font class="keyword">const</font>;
00078     <font class="keywordtype">void</font> set_(<font class="keyword">const</font> T&amp; val);
00079     <font class="keywordtype">void</font> destroy_();
00080         <font class="keyword">inline</font> <font class="keyword">const</font> T* begin_() <font class="keyword">const</font>;
00081         <font class="keyword">inline</font> T* begin_();
00082 
00083   <font class="keyword">public</font>:
00084 
<a name="l00085"></a><a class="code" href="class_TNT__Array3D.html#s0">00085</a>     <font class="keyword">typedef</font>         T   value_type;
00086 
00087                <a class="code" href="class_TNT__Array3D.html#a0">Array3D</a>();
00088                <a class="code" href="class_TNT__Array3D.html#a0">Array3D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k);
00089                <a class="code" href="class_TNT__Array3D.html#a0">Array3D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k,  T *a);
00090                <a class="code" href="class_TNT__Array3D.html#a0">Array3D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k, <font class="keyword">const</font> T &amp;a);
00091     <font class="keyword">inline</font> <a class="code" href="class_TNT__Array3D.html#a0">Array3D</a>(<font class="keyword">const</font> Array3D &amp;A);
00092         <font class="keyword">inline</font> Array3D &amp; <a class="code" href="class_TNT__Array3D.html#a5">operator=</a>(<font class="keyword">const</font> T &amp;a);
00093         <font class="keyword">inline</font> Array3D &amp; <a class="code" href="class_TNT__Array3D.html#a5">operator=</a>(<font class="keyword">const</font> Array3D &amp;A);
00094         <font class="keyword">inline</font> Array3D &amp; <a class="code" href="class_TNT__Array3D.html#a7">ref</a>(<font class="keyword">const</font> Array3D &amp;A);
00095                Array3D <a class="code" href="class_TNT__Array3D.html#a8">copy</a>() <font class="keyword">const</font>;
00096                    Array3D &amp; <a class="code" href="class_TNT__Array3D.html#a9">inject</a>(<font class="keyword">const</font> Array3D &amp; A);
00097         <font class="keyword">inline</font> T** <a class="code" href="class_TNT__Array3D.html#a10">operator[]</a>(<font class="keywordtype">int</font> i);
00098         <font class="keyword">inline</font> <font class="keyword">const</font> T* <font class="keyword">const</font> * <a class="code" href="class_TNT__Array3D.html#a10">operator[]</a>(<font class="keywordtype">int</font> i) <font class="keyword">const</font>;
00099         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array3D.html#a12">dim1</a>() <font class="keyword">const</font>;
00100         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array3D.html#a13">dim2</a>() <font class="keyword">const</font>;
00101         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array3D.html#a14">dim3</a>() <font class="keyword">const</font>;
00102         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array3D.html#a15">ref_count</a>() <font class="keyword">const</font>;
00103                <a class="code" href="class_TNT__Array3D.html#a16">~Array3D</a>();
00104 
00105 
00106 };
00107 
00108 
00115 template &lt;class T&gt;
<a name="l00116"></a><a class="code" href="class_TNT__Array3D.html#a4">00116</a> Array3D&lt;T&gt;::Array3D(<font class="keyword">const</font> Array3D&lt;T&gt; &amp;A) : v_(A.v_), m_(A.m_), 
00117         n_(A.n_), k_(A.k_), ref_count_(A.ref_count_)
00118 {
00119         (*ref_count_)++;
00120 }
00121 
00122 
00123 
00136 template &lt;class T&gt;
<a name="l00137"></a><a class="code" href="class_TNT__Array3D.html#a1">00137</a> Array3D&lt;T&gt;::Array3D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k) : v_(0), m_(m), n_(n), k_(k), ref_count_(0)
00138 {
00139         initialize_(<font class="keyword">new</font> T[m*n*k], m,n,k);
00140         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00141         *ref_count_ = 1;
00142 }
00143 
00144 
00145 
00156 template &lt;class T&gt;
<a name="l00157"></a><a class="code" href="class_TNT__Array3D.html#a3">00157</a> Array3D&lt;T&gt;::Array3D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k, <font class="keyword">const</font> T &amp;val) : v_(0), m_(m), n_(n) ,
00158         k_(k), ref_count_(0)
00159 {
00160         initialize_(<font class="keyword">new</font> T[m*n*k], m,n,k);
00161         set_(val);
00162         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00163         *ref_count_ = 1;
00164 
00165 }
00166 
00181 template &lt;class T&gt;
<a name="l00182"></a><a class="code" href="class_TNT__Array3D.html#a2">00182</a> Array3D&lt;T&gt;::Array3D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k, T *a) : v_(0), m_(m), n_(n) ,
00183         k_(k), ref_count_(0)
00184 {
00185         initialize_(a, m, n, k);
00186         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00187         *ref_count_ = 2;                <font class="comment">/* this avoids destorying original data. */</font>
00188 
00189 }
00190 
00191 
00201 template &lt;class T&gt;
<a name="l00202"></a><a class="code" href="class_TNT__Array3D.html#a10">00202</a> <font class="keyword">inline</font> T** Array3D&lt;T&gt;::operator[](<font class="keywordtype">int</font> i)<font class="keyword"> </font>
00203 <font class="keyword"></font>{ 
00204 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00205 <font class="preprocessor"></font>        assert(i &gt;= 0);
00206         assert(i &lt; m_);
00207 <font class="preprocessor">#endif</font>
00208 <font class="preprocessor"></font>
00209 <font class="keywordflow">return</font> v_[i]; 
00210 
00211 }
00212 
00213 template &lt;class T&gt;
<a name="l00214"></a><a class="code" href="class_TNT__Array3D.html#a11">00214</a> <font class="keyword">inline</font> <font class="keyword">const</font> T* <font class="keyword">const</font> * Array3D&lt;T&gt;::operator[](<font class="keywordtype">int</font> i)<font class="keyword"> const </font>{ <font class="keywordflow">return</font> v_[i]; }
00215 
00219 template &lt;class T&gt;
<a name="l00220"></a><a class="code" href="class_TNT__Array3D.html#a5">00220</a> Array3D&lt;T&gt; &amp; Array3D&lt;T&gt;::operator=(<font class="keyword">const</font> T &amp;a)<font class="keyword"></font>
00221 <font class="keyword"></font>{
00222         set_(a);
00223         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00224 }
00231 template &lt;class T&gt;
<a name="l00232"></a><a class="code" href="class_TNT__Array3D.html#a8">00232</a> Array3D&lt;T&gt; Array3D&lt;T&gt;::copy()<font class="keyword"> const</font>
00233 <font class="keyword"></font>{
00234         Array3D A(m_, n_, k_);
00235         copy_(A.begin_(), begin_(), m_*n_*k_);
00236 
00237         <font class="keywordflow">return</font> A;
00238 }
00239 
00240 
00264 template &lt;class T&gt;
<a name="l00265"></a><a class="code" href="class_TNT__Array3D.html#a9">00265</a> Array3D&lt;T&gt; &amp; Array3D&lt;T&gt;::inject(<font class="keyword">const</font> Array3D &amp;A)<font class="keyword"></font>
00266 <font class="keyword"></font>{
00267         <font class="keywordflow">if</font> (A.m_ == m_ &amp;&amp;  A.n_ == n_)
00268                 copy_(begin_(), A.begin_(), m_*n_);
00269 
00270         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00271 }
00272 
00273 
00274 
00275 
00276 
00287 template &lt;class T&gt;
<a name="l00288"></a><a class="code" href="class_TNT__Array3D.html#a7">00288</a> Array3D&lt;T&gt; &amp; Array3D&lt;T&gt;::ref(<font class="keyword">const</font> Array3D&lt;T&gt; &amp;A)<font class="keyword"></font>
00289 <font class="keyword"></font>{
00290         <font class="keywordflow">if</font> (<font class="keyword">this</font> != &amp;A)
00291         {
00292                 (*ref_count_) --;
00293                 <font class="keywordflow">if</font> ( *ref_count_ &lt; 1 )
00294                 {
00295                         destroy_();
00296                 }
00297 
00298                 m_ = A.m_;
00299                 n_ = A.n_;
00300                 k_ = A.k_;
00301                 v_ = A.v_;
00302                 ref_count_ = A.ref_count_;
00303 
00304                 (*ref_count_) ++ ;
00305                 
00306         }
00307         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00308 }
00309 
00313 template &lt;class T&gt;
<a name="l00314"></a><a class="code" href="class_TNT__Array3D.html#a6">00314</a> Array3D&lt;T&gt; &amp; Array3D&lt;T&gt;::operator=(<font class="keyword">const</font> Array3D&lt;T&gt; &amp;A)<font class="keyword"></font>
00315 <font class="keyword"></font>{
00316         <font class="keywordflow">return</font> <a class="code" href="class_TNT__Array3D.html#a7">ref</a>(A);
00317 }
00318 
00322 template &lt;class T&gt;
<a name="l00323"></a><a class="code" href="class_TNT__Array3D.html#a12">00323</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array3D&lt;T&gt;::dim1()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_; }
00324 
00328 template &lt;class T&gt;
<a name="l00329"></a><a class="code" href="class_TNT__Array3D.html#a13">00329</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array3D&lt;T&gt;::dim2()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> n_; }
00330 
00334 template &lt;class T&gt;
<a name="l00335"></a><a class="code" href="class_TNT__Array3D.html#a14">00335</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array3D&lt;T&gt;::dim3()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> k_; }
00336 
00337 
00342 template &lt;class T&gt;
<a name="l00343"></a><a class="code" href="class_TNT__Array3D.html#a15">00343</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array3D&lt;T&gt;::ref_count()<font class="keyword"> const</font>
00344 <font class="keyword"></font>{
00345         <font class="keywordflow">return</font> *ref_count_;
00346 }
00347 
00348 template &lt;class T&gt;
<a name="l00349"></a><a class="code" href="class_TNT__Array3D.html#a16">00349</a> Array3D&lt;T&gt;::~Array3D()<font class="keyword"></font>
00350 <font class="keyword"></font>{
00351         (*ref_count_) --;
00352 
00353         <font class="keywordflow">if</font> (*ref_count_ &lt; 1)
00354                 destroy_();
00355 }
00356 
00357 <font class="comment">/* private internal functions */</font>
00358 
00359 template &lt;class T&gt;
00360 <font class="keywordtype">void</font> Array3D&lt;T&gt;::initialize_( T* data, <font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keywordtype">int</font> k)<font class="keyword"></font>
00361 <font class="keyword"></font>{
00362 
00363         v_ = <font class="keyword">new</font> T**[m];
00364         v_[0] = <font class="keyword">new</font> T*[m*n];
00365         v_[0][0] = data;
00366 
00367 
00368         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;m; i++)
00369         {
00370                 v_[i] = v_[0] + i * n;
00371                 <font class="keywordflow">for</font> (<font class="keywordtype">int</font> j=0; j&lt;n; j++)
00372                         v_[i][j] = v_[0][0] + i * (n*k) + j * k;
00373         }
00374 
00375         m_ = m;
00376         n_ = n;
00377         k_ = k;
00378 }
00379 
00380 template &lt;class T&gt;
00381 <font class="keywordtype">void</font> Array3D&lt;T&gt;::set_(<font class="keyword">const</font> T&amp; a)<font class="keyword"></font>
00382 <font class="keyword"></font>{
00383         T *begin = &amp;(v_[0][0][0]);
00384         T *end = begin+ m_*n_*k_;
00385 
00386         <font class="keywordflow">for</font> (T* p=begin; p&lt;end; p++)
00387                 *p = a;
00388 
00389 }
00390 
00391 template &lt;class T&gt;
00392 <font class="keywordtype">void</font> Array3D&lt;T&gt;::copy_(T* p, <font class="keyword">const</font> T* q, <font class="keywordtype">int</font> len)<font class="keyword"> const</font>
00393 <font class="keyword"></font>{
00394         T *end = p + len;
00395         <font class="keywordflow">while</font> (p&lt;end )
00396                 *p++ = *q++;
00397 
00398 }
00399 
00400 template &lt;class T&gt;
00401 <font class="keywordtype">void</font> Array3D&lt;T&gt;::destroy_()<font class="keyword"></font>
00402 <font class="keyword"></font>{
00403 
00404         <font class="keywordflow">if</font> (v_ != 0)
00405         {
00406                 <font class="keyword">delete</font>[] (v_[0][0]);
00407                 <font class="keyword">delete</font>[] (v_[0]);
00408                 <font class="keyword">delete</font>[] (v_);
00409         }
00410 
00411         <font class="keywordflow">if</font> (ref_count_ != 0)
00412                 <font class="keyword">delete</font> ref_count_;
00413 }
00414 
00418 template &lt;class T&gt;
00419 <font class="keyword">const</font> T* Array3D&lt;T&gt;::begin_()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> &amp;(v_[0][0][0]); }
00420 
00424 template &lt;class T&gt;
00425 T* Array3D&lt;T&gt;::begin_()<font class="keyword"> </font>{ <font class="keywordflow">return</font> &amp;(v_[0][0][0]); }
00426 
00430 template &lt;class T&gt;
<a name="l00431"></a><a class="code" href="class_TNT__Array3D.html#a0">00431</a> Array3D&lt;T&gt;::Array3D() : v_(0), m_(0), n_(0) 
00432 {
00433         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00434         *ref_count_ = 1;
00435 }
00436 
00437 } <font class="comment">/* namespace TNT */</font>
00438 
00439 <font class="preprocessor">#endif</font>
00440 <font class="preprocessor"></font><font class="comment">/* TNT_ARRAY3D_H */</font>
00441 
</div></pre><hr><address><small>Generated at Wed Aug 28 02:51:39 2002 for TemplateNumericalToolkit(TNT) by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.5 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
