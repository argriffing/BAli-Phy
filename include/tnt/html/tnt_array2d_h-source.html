<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tnt_array2d.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.5 on Wed Aug 28 02:51:39 2002 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>tnt_array2d.h</h1><a href="tnt_array2d_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">*</font>
00003 <font class="comment">* Template Numerical Toolkit (TNT): Two-dimensional numerical array</font>
00004 <font class="comment">*</font>
00005 <font class="comment">* Mathematical and Computational Sciences Division</font>
00006 <font class="comment">* National Institute of Technology,</font>
00007 <font class="comment">* Gaithersburg, MD USA</font>
00008 <font class="comment">*</font>
00009 <font class="comment">*</font>
00010 <font class="comment">* This software was developed at the National Institute of Standards and</font>
00011 <font class="comment">* Technology (NIST) by employees of the Federal Government in the course</font>
00012 <font class="comment">* of their official duties. Pursuant to title 17 Section 105 of the</font>
00013 <font class="comment">* United States Code, this software is not subject to copyright protection</font>
00014 <font class="comment">* and is in the public domain. NIST assumes no responsibility whatsoever for</font>
00015 <font class="comment">* its use by other parties, and makes no guarantees, expressed or implied,</font>
00016 <font class="comment">* about its quality, reliability, or any other characteristic.</font>
00017 <font class="comment">*</font>
00018 <font class="comment">*/</font>
00019 
00020 
00021 
00022 <font class="preprocessor">#ifndef TNT_ARRAY2D_H</font>
00023 <font class="preprocessor"></font><font class="preprocessor">#define TNT_ARRAY2D_H</font>
00024 <font class="preprocessor"></font>
00025 <font class="preprocessor">#include &lt;cstdlib&gt;</font>
00026 <font class="preprocessor">#include &lt;iostream&gt;</font>
00027 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00028 <font class="preprocessor"></font><font class="preprocessor">#include &lt;assert.h&gt;</font>
00029 <font class="preprocessor">#endif</font>
00030 <font class="preprocessor"></font>
00031 <font class="keyword">namespace </font>TNT
00032 {
00033 
00063 template &lt;class T&gt;
<a name="l00064"></a><a class="code" href="class_TNT__Array2D.html">00064</a> <font class="keyword">class </font>Array2D 
00065 {
00066 
00067 
00068   <font class="keyword">private</font>:
00069     T** v_;                  
00070         <font class="keywordtype">int</font> m_;
00071     <font class="keywordtype">int</font> n_;
00072     <font class="keywordtype">int</font> *ref_count_;
00073 
00074         <font class="keywordtype">void</font> initialize_(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n);
00075     <font class="keywordtype">void</font> copy_(T* p, <font class="keyword">const</font> T*  q, <font class="keywordtype">int</font> len) <font class="keyword">const</font>;
00076     <font class="keywordtype">void</font> set_(<font class="keyword">const</font> T&amp; val);
00077     <font class="keywordtype">void</font> destroy_();
00078         <font class="keyword">inline</font> <font class="keyword">const</font> T* begin_() <font class="keyword">const</font>;
00079         <font class="keyword">inline</font> T* begin_();
00080 
00081   <font class="keyword">public</font>:
00082 
<a name="l00083"></a><a class="code" href="class_TNT__Array2D.html#s0">00083</a>     <font class="keyword">typedef</font>         T   value_type;
00084 
00085                <a class="code" href="class_TNT__Array2D.html#a0">Array2D</a>();
00086                <a class="code" href="class_TNT__Array2D.html#a0">Array2D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n);
00087                <a class="code" href="class_TNT__Array2D.html#a0">Array2D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n,  T *a);
00088                <a class="code" href="class_TNT__Array2D.html#a0">Array2D</a>(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keyword">const</font> T &amp;a);
00089     <font class="keyword">inline</font> <a class="code" href="class_TNT__Array2D.html#a0">Array2D</a>(<font class="keyword">const</font> Array2D &amp;A);
00090         <font class="keyword">inline</font> Array2D &amp; <a class="code" href="class_TNT__Array2D.html#a5">operator=</a>(<font class="keyword">const</font> T &amp;a);
00091         <font class="keyword">inline</font> Array2D &amp; <a class="code" href="class_TNT__Array2D.html#a5">operator=</a>(<font class="keyword">const</font> Array2D &amp;A);
00092         <font class="keyword">inline</font> Array2D &amp; <a class="code" href="class_TNT__Array2D.html#a7">ref</a>(<font class="keyword">const</font> Array2D &amp;A);
00093                Array2D <a class="code" href="class_TNT__Array2D.html#a8">copy</a>() <font class="keyword">const</font>;
00094                    Array2D &amp; <a class="code" href="class_TNT__Array2D.html#a9">inject</a>(<font class="keyword">const</font> Array2D &amp; A);
00095         <font class="keyword">inline</font> T* <a class="code" href="class_TNT__Array2D.html#a10">operator[]</a>(<font class="keywordtype">int</font> i);
00096         <font class="keyword">inline</font> <font class="keyword">const</font> T* <a class="code" href="class_TNT__Array2D.html#a10">operator[]</a>(<font class="keywordtype">int</font> i) <font class="keyword">const</font>;
00097         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array2D.html#a12">dim1</a>() <font class="keyword">const</font>;
00098         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array2D.html#a13">dim2</a>() <font class="keyword">const</font>;
00099         <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="class_TNT__Array2D.html#a14">ref_count</a>() <font class="keyword">const</font>;
00100                <a class="code" href="class_TNT__Array2D.html#a15">~Array2D</a>();
00101 
00102 
00103 };
00104 
00105 
00112 template &lt;class T&gt;
<a name="l00113"></a><a class="code" href="class_TNT__Array2D.html#a4">00113</a> Array2D&lt;T&gt;::Array2D(<font class="keyword">const</font> Array2D&lt;T&gt; &amp;A) : v_(A.v_), m_(A.m_), 
00114         n_(A.n_), ref_count_(A.ref_count_)
00115 {
00116         (*ref_count_)++;
00117 }
00118 
00119 
00120 
00132 template &lt;class T&gt;
<a name="l00133"></a><a class="code" href="class_TNT__Array2D.html#a1">00133</a> Array2D&lt;T&gt;::Array2D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n) : v_(0), m_(m), n_(n), ref_count_(0)
00134 {
00135         initialize_(m,n);
00136         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00137         *ref_count_ = 1;
00138 }
00139 
00140 
00141 
00151 template &lt;class T&gt;
<a name="l00152"></a><a class="code" href="class_TNT__Array2D.html#a3">00152</a> Array2D&lt;T&gt;::Array2D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, <font class="keyword">const</font> T &amp;val) : v_(0), m_(m), n_(n) ,
00153         ref_count_(0)
00154 {
00155         initialize_(m,n);
00156         set_(val);
00157         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00158         *ref_count_ = 1;
00159 
00160 }
00161 
00174 template &lt;class T&gt;
<a name="l00175"></a><a class="code" href="class_TNT__Array2D.html#a2">00175</a> Array2D&lt;T&gt;::Array2D(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n, T *a) : v_(0), m_(m), n_(n) ,
00176         ref_count_(0)
00177 {
00178         T* p = a;
00179         v_ = <font class="keyword">new</font> T*[m];
00180         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;m; i++)
00181         {
00182                 v_[i] = p;
00183                 p += n;
00184         }
00185         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00186         *ref_count_ = 2;                <font class="comment">/* this avoid destorying original data. */</font>
00187 
00188 }
00189 
00190 
00202 template &lt;class T&gt;
<a name="l00203"></a><a class="code" href="class_TNT__Array2D.html#a10">00203</a> <font class="keyword">inline</font> T* Array2D&lt;T&gt;::operator[](<font class="keywordtype">int</font> i)<font class="keyword"> </font>
00204 <font class="keyword"></font>{ 
00205 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00206 <font class="preprocessor"></font>        assert(i &gt;= 0);
00207         assert(i &lt; m_);
00208 <font class="preprocessor">#endif</font>
00209 <font class="preprocessor"></font>
00210 <font class="keywordflow">return</font> v_[i]; 
00211 
00212 }
00213 
00214 template &lt;class T&gt;
<a name="l00215"></a><a class="code" href="class_TNT__Array2D.html#a11">00215</a> <font class="keyword">inline</font> <font class="keyword">const</font> T* Array2D&lt;T&gt;::operator[](<font class="keywordtype">int</font> i)<font class="keyword"> const </font>{ <font class="keywordflow">return</font> v_[i]; }
00216 
00220 template &lt;class T&gt;
<a name="l00221"></a><a class="code" href="class_TNT__Array2D.html#a5">00221</a> Array2D&lt;T&gt; &amp; Array2D&lt;T&gt;::operator=(<font class="keyword">const</font> T &amp;a)<font class="keyword"></font>
00222 <font class="keyword"></font>{
00223         set_(a);
00224         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00225 }
00232 template &lt;class T&gt;
<a name="l00233"></a><a class="code" href="class_TNT__Array2D.html#a8">00233</a> Array2D&lt;T&gt; Array2D&lt;T&gt;::copy()<font class="keyword"> const</font>
00234 <font class="keyword"></font>{
00235         Array2D A(m_, n_);
00236         copy_(A.begin_(), begin_(), m_*n_);
00237 
00238         <font class="keywordflow">return</font> A;
00239 }
00240 
00241 
00265 template &lt;class T&gt;
<a name="l00266"></a><a class="code" href="class_TNT__Array2D.html#a9">00266</a> Array2D&lt;T&gt; &amp; Array2D&lt;T&gt;::inject(<font class="keyword">const</font> Array2D &amp;A)<font class="keyword"></font>
00267 <font class="keyword"></font>{
00268         <font class="keywordflow">if</font> (A.m_ == m_ &amp;&amp;  A.n_ == n_)
00269                 copy_(begin_(), A.begin_(), m_*n_);
00270 
00271         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00272 }
00273 
00274 
00275 
00276 
00277 
00288 template &lt;class T&gt;
<a name="l00289"></a><a class="code" href="class_TNT__Array2D.html#a7">00289</a> Array2D&lt;T&gt; &amp; Array2D&lt;T&gt;::ref(<font class="keyword">const</font> Array2D&lt;T&gt; &amp;A)<font class="keyword"></font>
00290 <font class="keyword"></font>{
00291         <font class="keywordflow">if</font> (<font class="keyword">this</font> != &amp;A)
00292         {
00293                 (*ref_count_) --;
00294                 <font class="keywordflow">if</font> ( *ref_count_ &lt; 1 )
00295                 {
00296                         destroy_();
00297                 }
00298 
00299                 m_ = A.m_;
00300                 n_ = A.n_;
00301                 v_ = A.v_;
00302                 ref_count_ = A.ref_count_;
00303 
00304                 (*ref_count_) ++ ;
00305                 
00306         }
00307         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00308 }
00309 
00313 template &lt;class T&gt;
<a name="l00314"></a><a class="code" href="class_TNT__Array2D.html#a6">00314</a> Array2D&lt;T&gt; &amp; Array2D&lt;T&gt;::operator=(<font class="keyword">const</font> Array2D&lt;T&gt; &amp;A)<font class="keyword"></font>
00315 <font class="keyword"></font>{
00316         <font class="keywordflow">return</font> <a class="code" href="class_TNT__Array2D.html#a7">ref</a>(A);
00317 }
00318 
00323 template &lt;class T&gt;
<a name="l00324"></a><a class="code" href="class_TNT__Array2D.html#a12">00324</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array2D&lt;T&gt;::dim1()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_; }
00325 
00330 template &lt;class T&gt;
<a name="l00331"></a><a class="code" href="class_TNT__Array2D.html#a13">00331</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array2D&lt;T&gt;::dim2()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> n_; }
00332 
00333 
00338 template &lt;class T&gt;
<a name="l00339"></a><a class="code" href="class_TNT__Array2D.html#a14">00339</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> Array2D&lt;T&gt;::ref_count()<font class="keyword"> const</font>
00340 <font class="keyword"></font>{
00341         <font class="keywordflow">return</font> *ref_count_;
00342 }
00343 
00344 template &lt;class T&gt;
<a name="l00345"></a><a class="code" href="class_TNT__Array2D.html#a15">00345</a> Array2D&lt;T&gt;::~Array2D()<font class="keyword"></font>
00346 <font class="keyword"></font>{
00347         (*ref_count_) --;
00348 
00349         <font class="keywordflow">if</font> (*ref_count_ &lt; 1)
00350                 destroy_();
00351 }
00352 
00353 <font class="comment">/* private internal functions */</font>
00354 
00355 template &lt;class T&gt;
00356 <font class="keywordtype">void</font> Array2D&lt;T&gt;::initialize_(<font class="keywordtype">int</font> m, <font class="keywordtype">int</font> n)<font class="keyword"></font>
00357 <font class="keyword"></font>{
00358 
00359 
00360         T* p = <font class="keyword">new</font> T[m*n];
00361         v_ = <font class="keyword">new</font> T*[m];
00362         <font class="keywordflow">for</font> (<font class="keywordtype">int</font> i=0; i&lt;m; i++)
00363         {
00364                 v_[i] = p;
00365                 p+=n;
00366         }
00367         m_ = m;
00368         n_ = n;
00369 }
00370 
00371 template &lt;class T&gt;
00372 <font class="keywordtype">void</font> Array2D&lt;T&gt;::set_(<font class="keyword">const</font> T&amp; a)<font class="keyword"></font>
00373 <font class="keyword"></font>{
00374         T *begin = &amp;v_[0][0];
00375         T *end = begin+ m_*n_;
00376 
00377         <font class="keywordflow">for</font> (T* p=begin; p&lt;end; p++)
00378                 *p = a;
00379 
00380 }
00381 
00382 template &lt;class T&gt;
00383 <font class="keywordtype">void</font> Array2D&lt;T&gt;::copy_(T* p, <font class="keyword">const</font> T* q, <font class="keywordtype">int</font> len)<font class="keyword"> const</font>
00384 <font class="keyword"></font>{
00385         T *end = p + len;
00386         <font class="keywordflow">while</font> (p&lt;end )
00387                 *p++ = *q++;
00388 
00389 }
00390 
00391 template &lt;class T&gt;
00392 <font class="keywordtype">void</font> Array2D&lt;T&gt;::destroy_()<font class="keyword"></font>
00393 <font class="keyword"></font>{
00394 
00395         <font class="keywordflow">if</font> (v_ != 0)
00396         {
00397                 <font class="keyword">delete</font>[] (v_[0]);
00398                 <font class="keyword">delete</font>[] (v_);
00399         }
00400 
00401         <font class="keywordflow">if</font> (ref_count_ != 0)
00402                 <font class="keyword">delete</font> ref_count_;
00403 }
00404 
00408 template &lt;class T&gt;
00409 <font class="keyword">const</font> T* Array2D&lt;T&gt;::begin_()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> &amp;(v_[0][0]); }
00410 
00414 template &lt;class T&gt;
00415 T* Array2D&lt;T&gt;::begin_()<font class="keyword"> </font>{ <font class="keywordflow">return</font> &amp;(v_[0][0]); }
00416 
00420 template &lt;class T&gt;
<a name="l00421"></a><a class="code" href="class_TNT__Array2D.html#a0">00421</a> Array2D&lt;T&gt;::Array2D() : v_(0), m_(0), n_(0) 
00422 {
00423         ref_count_ = <font class="keyword">new</font> <font class="keywordtype">int</font>;
00424         *ref_count_ = 1;
00425 }
00426 
00427 
00428 
00429 
00430 
00431 } <font class="comment">/* namespace TNT */</font>
00432 
00433 <font class="preprocessor">#endif</font>
00434 <font class="preprocessor"></font><font class="comment">/* TNT_ARRAY2D_H */</font>
00435 
</div></pre><hr><address><small>Generated at Wed Aug 28 02:51:39 2002 for TemplateNumericalToolkit(TNT) by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.5 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
