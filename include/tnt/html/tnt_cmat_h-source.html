<!DOCTYPE HTML PUBLIC "-//W3C//DTD HTML 4.0 Transitional//EN">
<html><head><meta name="robots" content="noindex">
<meta http-equiv="Content-Type" content="text/html;charset=iso-8859-1">
<title>tnt_cmat.h Source File</title>
<link href="doxygen.css" rel="stylesheet" type="text/css">
</head><body bgcolor="#ffffff">
<!-- Generated by Doxygen 1.2.5 on Wed Aug 28 02:51:39 2002 -->
<center>
<a class="qindex" href="index.html">Main Page</a> &nbsp; <a class="qindex" href="namespaces.html">Namespace List</a> &nbsp; <a class="qindex" href="annotated.html">Compound List</a> &nbsp; <a class="qindex" href="files.html">File List</a> &nbsp; <a class="qindex" href="namespacemembers.html">Namespace Members</a> &nbsp; <a class="qindex" href="functions.html">Compound Members</a> &nbsp; <a class="qindex" href="globals.html">File Members</a> &nbsp; </center>
<hr><h1>tnt_cmat.h</h1><a href="tnt_cmat_h.html">Go to the documentation of this file.</a><div class="fragment"><pre>00001 <font class="comment">/*</font>
00002 <font class="comment">*</font>
00003 <font class="comment">* Template Numerical Toolkit (TNT)</font>
00004 <font class="comment">*</font>
00005 <font class="comment">* Mathematical and Computational Sciences Division</font>
00006 <font class="comment">* National Institute of Technology,</font>
00007 <font class="comment">* Gaithersburg, MD USA</font>
00008 <font class="comment">*</font>
00009 <font class="comment">*</font>
00010 <font class="comment">* This software was developed at the National Institute of Standards and</font>
00011 <font class="comment">* Technology (NIST) by employees of the Federal Government in the course</font>
00012 <font class="comment">* of their official duties. Pursuant to title 17 Section 105 of the</font>
00013 <font class="comment">* United States Code, this software is not subject to copyright protection</font>
00014 <font class="comment">* and is in the public domain. NIST assumes no responsibility whatsoever for</font>
00015 <font class="comment">* its use by other parties, and makes no guarantees, expressed or implied,</font>
00016 <font class="comment">* about its quality, reliability, or any other characteristic.</font>
00017 <font class="comment">*</font>
00018 <font class="comment">*/</font>
00019 
00020 
00021 <font class="comment">// C compatible matrix: row-oriented, 0-based [i][j] and 1-based (i,j) indexing</font>
00022 <font class="comment">//</font>
00023 
00024 <font class="preprocessor">#ifndef TNT_CMAT_H</font>
00025 <font class="preprocessor"></font><font class="preprocessor">#define TNT_CMAT_H</font>
00026 <font class="preprocessor"></font>
00027 <font class="preprocessor">#include "<a class="code" href="tnt_subscript_h.html">tnt_subscript.h</a>"</font>
00028 <font class="preprocessor">#include "<a class="code" href="tnt_vec_h.html">tnt_vec.h</a>"</font>
00029 <font class="preprocessor">#include &lt;cstdlib&gt;</font>
00030 <font class="preprocessor">#include &lt;cassert&gt;</font>
00031 <font class="preprocessor">#include &lt;iostream&gt;</font>
00032 <font class="preprocessor">#include &lt;strstream&gt;</font>
00033 
00034 <font class="keyword">namespace </font>TNT
00035 {
00036 
00043 
00044 template &lt;class T&gt;
<a name="l00045"></a><a class="code" href="class_TNT__Matrix.html">00045</a> <font class="keyword">class </font>Matrix 
00046 {
00047 
00048 
00049   <font class="keyword">public</font>:
00050 
<a name="l00051"></a><a class="code" href="class_TNT__Matrix.html#s0">00051</a>     <font class="keyword">typedef</font> Subscript   size_type;
<a name="l00052"></a><a class="code" href="class_TNT__Matrix.html#s1">00052</a>     <font class="keyword">typedef</font>         T   value_type;
<a name="l00053"></a><a class="code" href="class_TNT__Matrix.html#s2">00053</a>     <font class="keyword">typedef</font>         T   element_type;
<a name="l00054"></a><a class="code" href="class_TNT__Matrix.html#s3">00054</a>     <font class="keyword">typedef</font>         T*  pointer;
<a name="l00055"></a><a class="code" href="class_TNT__Matrix.html#s4">00055</a>     <font class="keyword">typedef</font>         T*  iterator;
<a name="l00056"></a><a class="code" href="class_TNT__Matrix.html#s5">00056</a>     <font class="keyword">typedef</font>         T&amp;  reference;
<a name="l00057"></a><a class="code" href="class_TNT__Matrix.html#s6">00057</a>     <font class="keyword">typedef</font> <font class="keyword">const</font>   T*  const_iterator;
<a name="l00058"></a><a class="code" href="class_TNT__Matrix.html#s7">00058</a>     <font class="keyword">typedef</font> <font class="keyword">const</font>   T&amp;  const_reference;
00059 
<a name="l00060"></a><a class="code" href="class_TNT__Matrix.html#a0">00060</a>     Subscript <a class="code" href="class_TNT__Matrix.html#a0">lbound</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> 1;}
00061  
00062   <font class="keyword">protected</font>:
<a name="l00063"></a><a class="code" href="class_TNT__Matrix.html#n0">00063</a>     Subscript m_;
<a name="l00064"></a><a class="code" href="class_TNT__Matrix.html#n1">00064</a>     Subscript n_;
<a name="l00065"></a><a class="code" href="class_TNT__Matrix.html#n2">00065</a>     Subscript mn_;      <font class="comment">// total size</font>
<a name="l00066"></a><a class="code" href="class_TNT__Matrix.html#n3">00066</a>     T* v_;                  
<a name="l00067"></a><a class="code" href="class_TNT__Matrix.html#n4">00067</a>     T** row_;           
<a name="l00068"></a><a class="code" href="class_TNT__Matrix.html#n5">00068</a>     T* vm1_ ;       <font class="comment">// these point to the same data, but are 1-based </font>
<a name="l00069"></a><a class="code" href="class_TNT__Matrix.html#n6">00069</a>     T** rowm1_;
00070 
00071     <font class="comment">// internal helper function to create the array</font>
00072     <font class="comment">// of row pointers</font>
00073 
<a name="l00074"></a><a class="code" href="class_TNT__Matrix.html#b0">00074</a>     <font class="keywordtype">void</font> <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(Subscript M, Subscript N)<font class="keyword"></font>
00075 <font class="keyword">    </font>{
00076         mn_ = M*N;
00077         m_ = M;
00078         n_ = N;
00079 
00080         v_ = <font class="keyword">new</font> T[mn_]; 
00081         row_ = <font class="keyword">new</font> T*[M];
00082         rowm1_ = <font class="keyword">new</font> T*[M];
00083 
00084         assert(v_  != NULL);
00085         assert(row_  != NULL);
00086         assert(rowm1_ != NULL);
00087 
00088         T* p = v_;              
00089         vm1_ = v_ - 1;
00090         <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00091         {
00092             row_[i] = p;
00093             rowm1_[i] = p-1;
00094             p += N ;
00095             
00096         }
00097 
00098         rowm1_ -- ;     <font class="comment">// compensate for 1-based offset</font>
00099     }
00100    
<a name="l00101"></a><a class="code" href="class_TNT__Matrix.html#b1">00101</a>     <font class="keywordtype">void</font> <a class="code" href="class_TNT__Matrix.html#b1">copy</a>(<font class="keyword">const</font> T*  v)<font class="keyword"></font>
00102 <font class="keyword">    </font>{
00103         Subscript N = m_ * n_;
00104         Subscript i;
00105 
00106 <font class="preprocessor">#ifdef TNT_UNROLL_LOOPS</font>
00107 <font class="preprocessor"></font>        Subscript Nmod4 = N &amp; 3;
00108         Subscript N4 = N - Nmod4;
00109 
00110         <font class="keywordflow">for</font> (i=0; i&lt;N4; i+=4)
00111         {
00112             v_[i] = v[i];
00113             v_[i+1] = v[i+1];
00114             v_[i+2] = v[i+2];
00115             v_[i+3] = v[i+3];
00116         }
00117 
00118         <font class="keywordflow">for</font> (i=N4; i&lt; N; i++)
00119             v_[i] = v[i];
00120 <font class="preprocessor">#else</font>
00121 <font class="preprocessor"></font>
00122         <font class="keywordflow">for</font> (i=0; i&lt; N; i++)
00123             v_[i] = v[i];
00124 <font class="preprocessor">#endif      </font>
00125 <font class="preprocessor"></font>    }
00126 
<a name="l00127"></a><a class="code" href="class_TNT__Matrix.html#b2">00127</a>     <font class="keywordtype">void</font> <a class="code" href="class_TNT__Matrix.html#b2">set</a>(<font class="keyword">const</font> T&amp; val)<font class="keyword"></font>
00128 <font class="keyword">    </font>{
00129         Subscript N = m_ * n_;
00130         Subscript i;
00131 
00132 <font class="preprocessor">#ifdef TNT_UNROLL_LOOPS</font>
00133 <font class="preprocessor"></font>        Subscript Nmod4 = N &amp; 3;
00134         Subscript N4 = N - Nmod4;
00135 
00136         <font class="keywordflow">for</font> (i=0; i&lt;N4; i+=4)
00137         {
00138             v_[i] = val;
00139             v_[i+1] = val;
00140             v_[i+2] = val;
00141             v_[i+3] = val; 
00142         }
00143 
00144         <font class="keywordflow">for</font> (i=N4; i&lt; N; i++)
00145             v_[i] = val;
00146 <font class="preprocessor">#else</font>
00147 <font class="preprocessor"></font>
00148         <font class="keywordflow">for</font> (i=0; i&lt; N; i++)
00149             v_[i] = val;
00150         
00151 <font class="preprocessor">#endif      </font>
00152 <font class="preprocessor"></font>    }
00153     
00154 
00155     
<a name="l00156"></a><a class="code" href="class_TNT__Matrix.html#b3">00156</a>     <font class="keywordtype">void</font> <a class="code" href="class_TNT__Matrix.html#b3">destroy</a>()<font class="keyword"></font>
00157 <font class="keyword">    </font>{     
00158         <font class="comment">/* do nothing, if no memory has been previously allocated */</font>
00159         <font class="keywordflow">if</font> (v_ == NULL) <font class="keywordflow">return</font> ;
00160 
00161         <font class="comment">/* if we are here, then matrix was previously allocated */</font>
00162         <font class="keywordflow">if</font> (v_ != NULL) <font class="keyword">delete</font> [] (v_);     
00163         <font class="keywordflow">if</font> (row_ != NULL) <font class="keyword">delete</font> [] (row_);
00164 
00165         <font class="comment">/* return rowm1_ back to original value */</font>
00166         rowm1_ ++;
00167         <font class="keywordflow">if</font> (rowm1_ != NULL ) <font class="keyword">delete</font> [] (rowm1_);
00168     }
00169 
00170 
00171   <font class="keyword">public</font>:
00172 
<a name="l00173"></a><a class="code" href="class_TNT__Matrix.html#a1">00173</a>     <a class="code" href="class_TNT__Matrix.html#a1">operator T**</a>()<font class="keyword"></font>{ <font class="keywordflow">return</font>  row_; }
<a name="l00174"></a><a class="code" href="class_TNT__Matrix.html#a2">00174</a>     <a class="code" href="class_TNT__Matrix.html#a1">operator T**</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> row_; }
00175 
00176 
<a name="l00177"></a><a class="code" href="class_TNT__Matrix.html#a3">00177</a>     Subscript <a class="code" href="class_TNT__Matrix.html#a3">size</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> mn_; }
00178 
00179     <font class="comment">// constructors</font>
00180 
<a name="l00181"></a><a class="code" href="class_TNT__Matrix.html#a4">00181</a>     <a class="code" href="class_TNT__Matrix.html#a4">Matrix</a>() : m_(0), n_(0), mn_(0), v_(0), row_(0), vm1_(0), rowm1_(0) {};
00182 
<a name="l00183"></a><a class="code" href="class_TNT__Matrix.html#a5">00183</a>     <a class="code" href="class_TNT__Matrix.html#a4">Matrix</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A)<font class="keyword"></font>
00184 <font class="keyword">    </font>{
00185         <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(A.m_, A.n_);
00186         <a class="code" href="class_TNT__Matrix.html#b1">copy</a>(A.v_);
00187     }
00188 
<a name="l00189"></a><a class="code" href="class_TNT__Matrix.html#a6">00189</a>     <a class="code" href="class_TNT__Matrix.html#a4">Matrix</a>(Subscript M, Subscript N, <font class="keyword">const</font> T&amp; value = T())
00190     {
00191         <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(M,N);
00192         <a class="code" href="class_TNT__Matrix.html#b2">set</a>(value);
00193     }
00194 
<a name="l00195"></a><a class="code" href="class_TNT__Matrix.html#a7">00195</a>     <a class="code" href="class_TNT__Matrix.html#a4">Matrix</a>(Subscript M, Subscript N, <font class="keyword">const</font> T* v)<font class="keyword"></font>
00196 <font class="keyword">    </font>{
00197         <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(M,N);
00198         <a class="code" href="class_TNT__Matrix.html#b1">copy</a>(v);
00199     }
00200 
<a name="l00201"></a><a class="code" href="class_TNT__Matrix.html#a8">00201</a>     <a class="code" href="class_TNT__Matrix.html#a4">Matrix</a>(Subscript M, Subscript N, <font class="keyword">const</font> <font class="keywordtype">char</font> *s)<font class="keyword"></font>
00202 <font class="keyword">    </font>{
00203         <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(M,N);
00204         std::istrstream ins(s);
00205 
00206         Subscript i, j;
00207 
00208         <font class="keywordflow">for</font> (i=0; i&lt;M; i++)
00209             <font class="keywordflow">for</font> (j=0; j&lt;N; j++)
00210                 ins &gt;&gt; row_[i][j];
00211     }
00212 
00213     <font class="comment">// destructor</font>
00214     <font class="comment">//</font>
<a name="l00215"></a><a class="code" href="class_TNT__Matrix.html#a9">00215</a>     <a class="code" href="class_TNT__Matrix.html#a9">~Matrix</a>()<font class="keyword"></font>
00216 <font class="keyword">    </font>{
00217         <a class="code" href="class_TNT__Matrix.html#b3">destroy</a>();
00218     }
00219 
00220 
00221     <font class="comment">// reallocating</font>
00222     <font class="comment">//</font>
<a name="l00223"></a><a class="code" href="class_TNT__Matrix.html#a10">00223</a>     Matrix&lt;T&gt;&amp; <a class="code" href="class_TNT__Matrix.html#a10">newsize</a>(Subscript M, Subscript N)<font class="keyword"></font>
00224 <font class="keyword">    </font>{
00225         <font class="keywordflow">if</font> (<a class="code" href="class_TNT__Matrix.html#a14">num_rows</a>() == M &amp;&amp; <a class="code" href="class_TNT__Matrix.html#a15">num_cols</a>() == N)
00226             <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00227 
00228         <a class="code" href="class_TNT__Matrix.html#b3">destroy</a>();
00229         <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(M,N);
00230         
00231         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00232     }
00233 
00234 
00235 
00236 
00237     <font class="comment">// assignments</font>
00238     <font class="comment">//</font>
<a name="l00239"></a><a class="code" href="class_TNT__Matrix.html#a11">00239</a>     Matrix&lt;T&gt;&amp; <a class="code" href="class_TNT__Matrix.html#a11">operator=</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A)<font class="keyword"></font>
00240 <font class="keyword">    </font>{
00241         <font class="keywordflow">if</font> (v_ == A.v_)
00242             <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00243 
00244         <font class="keywordflow">if</font> (m_ == A.m_  &amp;&amp; n_ == A.n_)      <font class="comment">// no need to re-alloc</font>
00245             <a class="code" href="class_TNT__Matrix.html#b1">copy</a>(A.v_);
00246 
00247         <font class="keywordflow">else</font>
00248         {
00249             <a class="code" href="class_TNT__Matrix.html#b3">destroy</a>();
00250             <a class="code" href="class_TNT__Matrix.html#b0">initialize</a>(A.m_, A.n_);
00251             <a class="code" href="class_TNT__Matrix.html#b1">copy</a>(A.v_);
00252         }
00253 
00254         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00255     }
00256         
<a name="l00257"></a><a class="code" href="class_TNT__Matrix.html#a12">00257</a>     Matrix&lt;T&gt;&amp; <a class="code" href="class_TNT__Matrix.html#a11">operator=</a>(<font class="keyword">const</font> T&amp; scalar)<font class="keyword"></font>
00258 <font class="keyword">    </font>{ 
00259         <a class="code" href="class_TNT__Matrix.html#b2">set</a>(scalar); 
00260         <font class="keywordflow">return</font> *<font class="keyword">this</font>;
00261     }
00262 
00263 
<a name="l00264"></a><a class="code" href="class_TNT__Matrix.html#a13">00264</a>     Subscript <a class="code" href="class_TNT__Matrix.html#a13">dim</a>(Subscript d)<font class="keyword"> const </font>
00265 <font class="keyword">    </font>{
00266 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00267 <font class="preprocessor"></font>        assert( d &gt;= 1);
00268         assert( d &lt;= 2);
00269 <font class="preprocessor">#endif</font>
00270 <font class="preprocessor"></font>        <font class="keywordflow">return</font> (d==1) ? m_ : ((d==2) ? n_ : 0); 
00271     }
00272 
<a name="l00273"></a><a class="code" href="class_TNT__Matrix.html#a14">00273</a>     Subscript <a class="code" href="class_TNT__Matrix.html#a14">num_rows</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> m_; }
<a name="l00274"></a><a class="code" href="class_TNT__Matrix.html#a15">00274</a>     Subscript <a class="code" href="class_TNT__Matrix.html#a15">num_cols</a>()<font class="keyword"> const </font>{ <font class="keywordflow">return</font> n_; }
00275 
00276 
00277 
00278 
<a name="l00279"></a><a class="code" href="class_TNT__Matrix.html#a16">00279</a>     <font class="keyword">inline</font> T* <a class="code" href="class_TNT__Matrix.html#a16">operator[]</a>(Subscript i)<font class="keyword"></font>
00280 <font class="keyword">    </font>{
00281 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00282 <font class="preprocessor"></font>        assert(0&lt;=i);
00283         assert(i &lt; m_) ;
00284 <font class="preprocessor">#endif</font>
00285 <font class="preprocessor"></font>        <font class="keywordflow">return</font> row_[i];
00286     }
00287 
<a name="l00288"></a><a class="code" href="class_TNT__Matrix.html#a17">00288</a>     <font class="keyword">inline</font> <font class="keyword">const</font> T* <a class="code" href="class_TNT__Matrix.html#a16">operator[]</a>(Subscript i)<font class="keyword"> const</font>
00289 <font class="keyword">    </font>{
00290 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00291 <font class="preprocessor"></font>        assert(0&lt;=i);
00292         assert(i &lt; m_) ;
00293 <font class="preprocessor">#endif</font>
00294 <font class="preprocessor"></font>        <font class="keywordflow">return</font> row_[i];
00295     }
00296 
<a name="l00297"></a><a class="code" href="class_TNT__Matrix.html#a18">00297</a>     <font class="keyword">inline</font> reference <a class="code" href="class_TNT__Matrix.html#a18">operator()</a>(Subscript i)<font class="keyword"></font>
00298 <font class="keyword">    </font>{ 
00299 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00300 <font class="preprocessor"></font>        assert(1&lt;=i);
00301         assert(i &lt;= mn_) ;
00302 <font class="preprocessor">#endif</font>
00303 <font class="preprocessor"></font>        <font class="keywordflow">return</font> vm1_[i]; 
00304     }
00305 
<a name="l00306"></a><a class="code" href="class_TNT__Matrix.html#a19">00306</a>     <font class="keyword">inline</font> const_reference <a class="code" href="class_TNT__Matrix.html#a18">operator()</a>(Subscript i)<font class="keyword"> const</font>
00307 <font class="keyword">    </font>{ 
00308 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00309 <font class="preprocessor"></font>        assert(1&lt;=i);
00310         assert(i &lt;= mn_) ;
00311 <font class="preprocessor">#endif</font>
00312 <font class="preprocessor"></font>        <font class="keywordflow">return</font> vm1_[i]; 
00313     }
00314 
00315 
00316 
<a name="l00317"></a><a class="code" href="class_TNT__Matrix.html#a20">00317</a>     <font class="keyword">inline</font> reference <a class="code" href="class_TNT__Matrix.html#a18">operator()</a>(Subscript i, Subscript j)<font class="keyword"></font>
00318 <font class="keyword">    </font>{ 
00319 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00320 <font class="preprocessor"></font>        assert(1&lt;=i);
00321         assert(i &lt;= m_) ;
00322         assert(1&lt;=j);
00323         assert(j &lt;= n_);
00324 <font class="preprocessor">#endif</font>
00325 <font class="preprocessor"></font>        <font class="keywordflow">return</font>  rowm1_[i][j]; 
00326     }
00327 
00328 
00329     
<a name="l00330"></a><a class="code" href="class_TNT__Matrix.html#a21">00330</a>     <font class="keyword">inline</font> const_reference <a class="code" href="class_TNT__Matrix.html#a18">operator() </a>(Subscript i, Subscript j)<font class="keyword"> const</font>
00331 <font class="keyword">    </font>{
00332 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00333 <font class="preprocessor"></font>        assert(1&lt;=i);
00334         assert(i &lt;= m_) ;
00335         assert(1&lt;=j);
00336         assert(j &lt;= n_);
00337 <font class="preprocessor">#endif</font>
00338 <font class="preprocessor"></font>        <font class="keywordflow">return</font> rowm1_[i][j]; 
00339     }
00340 
00341 
00342 
00343 
00344 };
00345 
00346 
00347 <font class="comment">/* ***************************  I/O  ********************************/</font>
00348 
00349 template &lt;class T&gt;
<a name="l00350"></a><a class="code" href="namespace_TNT.html#a8">00350</a> std::ostream&amp; operator&lt;&lt;(std::ostream &amp;s, const Matrix&lt;T&gt; &amp;A)
00351 {
00352     Subscript M=A.num_rows();
00353     Subscript N=A.num_cols();
00354 
00355     s &lt;&lt; M &lt;&lt; <font class="stringliteral">" "</font> &lt;&lt; N &lt;&lt; <font class="stringliteral">"\n"</font>;
00356 
00357     <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00358     {
00359         <font class="keywordflow">for</font> (Subscript j=0; j&lt;N; j++)
00360         {
00361             s &lt;&lt; A[i][j] &lt;&lt; <font class="stringliteral">" "</font>;
00362         }
00363         s &lt;&lt; <font class="stringliteral">"\n"</font>;
00364     }
00365 
00366 
00367     <font class="keywordflow">return</font> s;
00368 }
00369 
00370 template &lt;class T&gt;
<a name="l00371"></a><a class="code" href="namespace_TNT.html#a9">00371</a> std::istream&amp; <a class="code" href="namespace_TNT.html#a2">operator&gt;&gt;</a>(std::istream &amp;s, Matrix&lt;T&gt; &amp;A)<font class="keyword"></font>
00372 <font class="keyword"></font>{
00373 
00374     Subscript M, N;
00375 
00376     s &gt;&gt; M &gt;&gt; N;
00377 
00378     <font class="keywordflow">if</font> ( !(M == A.num_rows() &amp;&amp; N == A.num_cols() ))
00379     {
00380         A.newsize(M,N);
00381     }
00382 
00383 
00384     <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00385         <font class="keywordflow">for</font> (Subscript j=0; j&lt;N; j++)
00386         {
00387             s &gt;&gt;  A[i][j];
00388         }
00389 
00390 
00391     <font class="keywordflow">return</font> s;
00392 }
00393 
00394 <font class="comment">// *******************[ basic matrix algorithms ]***************************</font>
00395 
00396 
00397 template &lt;class T&gt;
<a name="l00398"></a><a class="code" href="namespace_TNT.html#a10">00398</a> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a10">operator+</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A, 
00399     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00400 <font class="keyword"></font>{
00401     Subscript M = A.num_rows();
00402     Subscript N = A.num_cols();
00403 
00404     assert(M==B.num_rows());
00405     assert(N==B.num_cols());
00406 
00407     Matrix&lt;T&gt; tmp(M,N);
00408     Subscript i,j;
00409 
00410     <font class="keywordflow">for</font> (i=0; i&lt;M; i++)
00411         <font class="keywordflow">for</font> (j=0; j&lt;N; j++)
00412             tmp[i][j] = A[i][j] + B[i][j];
00413 
00414     <font class="keywordflow">return</font> tmp;
00415 }
00416 
00417 template &lt;class T&gt;
<a name="l00418"></a><a class="code" href="namespace_TNT.html#a11">00418</a> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a11">operator-</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A, 
00419     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00420 <font class="keyword"></font>{
00421     Subscript M = A.num_rows();
00422     Subscript N = A.num_cols();
00423 
00424     assert(M==B.num_rows());
00425     assert(N==B.num_cols());
00426 
00427     Matrix&lt;T&gt; tmp(M,N);
00428     Subscript i,j;
00429 
00430     <font class="keywordflow">for</font> (i=0; i&lt;M; i++)
00431         <font class="keywordflow">for</font> (j=0; j&lt;N; j++)
00432             tmp[i][j] = A[i][j] - B[i][j];
00433 
00434     <font class="keywordflow">return</font> tmp;
00435 }
00436 
00437 template &lt;class T&gt;
<a name="l00438"></a><a class="code" href="namespace_TNT.html#a12">00438</a> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a12">mult_element</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A, 
00439     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00440 <font class="keyword"></font>{
00441     Subscript M = A.num_rows();
00442     Subscript N = A.num_cols();
00443 
00444     assert(M==B.num_rows());
00445     assert(N==B.num_cols());
00446 
00447     Matrix&lt;T&gt; tmp(M,N);
00448     Subscript i,j;
00449 
00450     <font class="keywordflow">for</font> (i=0; i&lt;M; i++)
00451         <font class="keywordflow">for</font> (j=0; j&lt;N; j++)
00452             tmp[i][j] = A[i][j] * B[i][j];
00453 
00454     <font class="keywordflow">return</font> tmp;
00455 }
00456 
00457 
00458 template &lt;class T&gt;
<a name="l00459"></a><a class="code" href="namespace_TNT.html#a13">00459</a> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a13">transpose</a>(<font class="keyword">const</font> Matrix&lt;T&gt; &amp;A)<font class="keyword"></font>
00460 <font class="keyword"></font>{
00461     Subscript M = A.num_rows();
00462     Subscript N = A.num_cols();
00463 
00464     Matrix&lt;T&gt; S(N,M);
00465     Subscript i, j;
00466 
00467     <font class="keywordflow">for</font> (i=0; i&lt;M; i++)
00468         <font class="keywordflow">for</font> (j=0; j&lt;N; j++)
00469             S[j][i] = A[i][j];
00470 
00471     <font class="keywordflow">return</font> S;
00472 }
00473 
00474 
00475     
00476 template &lt;class T&gt;
<a name="l00477"></a><a class="code" href="namespace_TNT.html#a14">00477</a> <font class="keyword">inline</font> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a5">matmult</a>(<font class="keyword">const</font> Matrix&lt;T&gt;  &amp;A, 
00478     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00479 <font class="keyword"></font>{
00480 
00481 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00482 <font class="preprocessor"></font>    assert(A.num_cols() == B.num_rows());
00483 <font class="preprocessor">#endif</font>
00484 <font class="preprocessor"></font>
00485     Subscript M = A.num_rows();
00486     Subscript N = A.num_cols();
00487     Subscript K = B.num_cols();
00488 
00489     Matrix&lt;T&gt; tmp(M,K);
00490     T sum;
00491 
00492     <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00493     <font class="keywordflow">for</font> (Subscript k=0; k&lt;K; k++)
00494     {
00495         sum = 0;
00496         <font class="keywordflow">for</font> (Subscript j=0; j&lt;N; j++)
00497             sum = sum +  A[i][j] * B[j][k];
00498 
00499         tmp[i][k] = sum; 
00500     }
00501 
00502     <font class="keywordflow">return</font> tmp;
00503 }
00504 
00505 template &lt;class T&gt;
<a name="l00506"></a><a class="code" href="namespace_TNT.html#a15">00506</a> <font class="keyword">inline</font> Matrix&lt;T&gt; <a class="code" href="namespace_TNT.html#a15">operator*</a>(<font class="keyword">const</font> Matrix&lt;T&gt;  &amp;A, 
00507     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00508 <font class="keyword"></font>{
00509     <font class="keywordflow">return</font> <a class="code" href="namespace_TNT.html#a5">matmult</a>(A,B);
00510 }
00511 
00512 template &lt;class T&gt;
<a name="l00513"></a><a class="code" href="namespace_TNT.html#a16">00513</a> <font class="keyword">inline</font> <font class="keywordtype">int</font> <a class="code" href="namespace_TNT.html#a5">matmult</a>(Matrix&lt;T&gt;&amp; C, <font class="keyword">const</font> Matrix&lt;T&gt;  &amp;A, 
00514     <font class="keyword">const</font> Matrix&lt;T&gt; &amp;B)<font class="keyword"></font>
00515 <font class="keyword"></font>{
00516 
00517     assert(A.num_cols() == B.num_rows());
00518 
00519     Subscript M = A.num_rows();
00520     Subscript N = A.num_cols();
00521     Subscript K = B.num_cols();
00522 
00523     C.newsize(M,K);
00524 
00525     T sum;
00526 
00527     <font class="keyword">const</font> T* row_i;
00528     <font class="keyword">const</font> T* col_k;
00529 
00530     <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00531     <font class="keywordflow">for</font> (Subscript k=0; k&lt;K; k++)
00532     {
00533         row_i  = &amp;(A[i][0]);
00534         col_k  = &amp;(B[0][k]);
00535         sum = 0;
00536         <font class="keywordflow">for</font> (Subscript j=0; j&lt;N; j++)
00537         {
00538             sum  += *row_i * *col_k;
00539             row_i++;
00540             col_k += K;
00541         }
00542         C[i][k] = sum; 
00543     }
00544 
00545     <font class="keywordflow">return</font> 0;
00546 }
00547 
00548 
00549 template &lt;class T&gt;
<a name="l00550"></a><a class="code" href="namespace_TNT.html#a17">00550</a> Vector&lt;T&gt; <a class="code" href="namespace_TNT.html#a5">matmult</a>(<font class="keyword">const</font> Matrix&lt;T&gt;  &amp;A, <font class="keyword">const</font> Vector&lt;T&gt; &amp;x)<font class="keyword"></font>
00551 <font class="keyword"></font>{
00552 
00553 <font class="preprocessor">#ifdef TNT_BOUNDS_CHECK</font>
00554 <font class="preprocessor"></font>    assert(A.num_cols() == x.dim());
00555 <font class="preprocessor">#endif</font>
00556 <font class="preprocessor"></font>
00557     Subscript M = A.num_rows();
00558     Subscript N = A.num_cols();
00559 
00560     Vector&lt;T&gt; tmp(M);
00561     T sum;
00562 
00563     <font class="keywordflow">for</font> (Subscript i=0; i&lt;M; i++)
00564     {
00565         sum = 0;
00566         <font class="keyword">const</font> T* rowi = A[i];
00567         <font class="keywordflow">for</font> (Subscript j=0; j&lt;N; j++)
00568             sum = sum +  rowi[j] * x[j];
00569 
00570         tmp[i] = sum; 
00571     }
00572 
00573     <font class="keywordflow">return</font> tmp;
00574 }
00575 
00576 template &lt;class T&gt;
<a name="l00577"></a><a class="code" href="namespace_TNT.html#a18">00577</a> <font class="keyword">inline</font> Vector&lt;T&gt; <a class="code" href="namespace_TNT.html#a15">operator*</a>(<font class="keyword">const</font> Matrix&lt;T&gt;  &amp;A, <font class="keyword">const</font> Vector&lt;T&gt; &amp;x)<font class="keyword"></font>
00578 <font class="keyword"></font>{
00579     <font class="keywordflow">return</font> <a class="code" href="namespace_TNT.html#a5">matmult</a>(A,x);
00580 }
00581 
00582 } <font class="comment">// namespace TNT</font>
00583 
00584 <font class="preprocessor">#endif</font>
00585 <font class="preprocessor"></font><font class="comment">// CMAT_H</font>
</div></pre><hr><address><small>Generated at Wed Aug 28 02:51:39 2002 for TemplateNumericalToolkit(TNT) by
<a href="http://www.doxygen.org/index.html">
<img src="doxygen.gif" alt="doxygen" align="middle" border=0 
width=110 height=53></a>1.2.5 written by <a href="mailto:dimitri@stack.nl">Dimitri van Heesch</a>,
 &copy;&nbsp;1997-2001</small></address>
</body>
</html>
